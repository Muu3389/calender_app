<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendar App</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>

<body>

    <form id="event-form" class="event-form" method="POST" action="/add">
        <h3>予定を追加</h3>
        <label>日付: <input type="text" name="event-date" id="event-date" readonly></label>
        <label>時間: <input type="time" name="event-time" id="event-time"></label>
        <label>内容: <input type="text" name="event-text" id="event-text"></label>

        <div class="color-picker">
            <span class="color-option" data-color="#e8f0fe" style="background:#e8f0fe;"></span>
            <span class="color-option" data-color="#ffe4e1" style="background:#ffe4e1;"></span>
            <span class="color-option" data-color="#fff3cd" style="background:#fff3cd;"></span>
            <span class="color-option" data-color="#d4edda" style="background:#d4edda;"></span>
            <span class="color-option" data-color="#cce5ff" style="background:#cce5ff;"></span>
            <span class="color-option" data-color="#f8d7da" style="background:#f8d7da;"></span>
            <span class="color-option" data-color="#e2e3e5" style="background:#e2e3e5;"></span>
            <span class="color-option" data-color="#d1ecf1" style="background:#d1ecf1;"></span>
        </div>

        <input type="hidden" name="event-color" id="event-color">

        <button type="submit" id="save-event">保存</button>
        <button type="button" id="cancel-event">キャンセル</button>
    </form>


    <h1>
        <form method="get" class="jump-form">
            <select name="year" id="year-select" onchange="this.form.submit()">
                {% for y in range(year-5, year+6) %}
                    <option value="{{ y }}" {% if y == year %}selected{% endif %}>{{ y }}年</option>
                {% endfor %}
            </select>
            <select name="month" id="month-select" onchange="this.form.submit()">
                {% for m in range(1, 13) %}
                    <option value="{{ m }}" {% if m == month %}selected{% endif %}>{{ m }}月</option>
                {% endfor %}
            </select>
        </form>
    </h1>

    <div class="nav">
        <a href="/?year={{ year if month > 1 else year-1 }}&month={{ month-1 if month > 1 else 12 }}">
            <button>前の月</button>
        </a>

        <a href="/?year={{ year if month < 12 else year+1 }}&month={{ month+1 if month < 12 else 1 }}">
            <button>次の月</button>
        </a>
    </div>

    <table>
        <tr class="weekday-row">
            <th>日</th><th>月</th><th>火</th><th>水</th><th>木</th><th>金</th><th>土</th>
        </tr>
        {% for week in month_days %}
        <tr>
            {% for day in week %}
                {% if day == 0 %}
                    <td class="empty"></td>
                {% else %}
                    <td data-date="{{ year }}-{{ '%02d' % month }}-{{ '%02d' % day }}" class="day-cell">
                        <div class="day-number">{{day}}</div>
                        {% if day in events%}
                            {% for title in events[day] %}
                                <div class="event" style="background-color: {{ title[2] }};">
                                    {{ title[1] }}
                                </div>
                            {% endfor %}
                        {% endif %}
                    </td>
                {% endif %}
            {% endfor %}
        </tr>
        {% endfor %}
    </table>

    <script src="{{ url_for('static', filename='script.js') }}"></script>

</body>

</html>
